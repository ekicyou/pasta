<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Lua 5.5 - Section 3.1</title>
</head>
<body>
<h2>3.1 – <a name="3.1">字句規則</a></h2>

<p>Luaは自由形式の言語です。2つのトークン間の区切り文字として以外は、字句要素（トークン）間のスペースとコメントを無視します。ソースコードでは、Luaは標準ASCII空白文字（スペース、改ページ、改行、復帰、水平タブ、垂直タブ）をスペースとして認識します。</p><p>
Luaの<em>名前</em>（<em>識別子</em>とも呼ばれる）は、ラテン文字、アラビア数字、およびアンダースコアで構成される任意の文字列で、数字で始まらず、予約語でないものであれば使用できます。識別子は、変数、テーブルフィールド、およびラベルに名前を付けるために使用されます。</p><p>次の<em>キーワード</em>は予約されており、名前として使用することはできません。</p><pre>     and       break     do        else      elseif    end
     false     for       function  goto      if        in
     local     nil       not       or        repeat    return
     then      true      until     while
</pre>

<p>Luaは大文字と小文字を区別する言語です。<code>and</code>は予約語ですが、<code>And</code>と<code>AND</code>は2つの異なる有効な名前です。慣例として、プログラムはアンダースコアと1つ以上の大文字（<a href="#pdf-_VERSION"><code>_VERSION</code></a>など）で始まる名前の作成を避ける必要があります。</p><p>次の文字列は、他のトークンを示します</p><pre>     +     -     *     /     %     ^     #
     &amp;     ~     |     &lt;&lt;    &gt;&gt;    //
     ==    ~=    &lt;=    &gt;=    &lt;     &gt;     =
     (     )     {     }     [     ]     ::
     ;     :     ,     .     ..    ...
</pre>

<p><em>短いリテラル文字列</em>は、一致する単一引用符または二重引用符で区切ることができ、次のCのようなエスケープシーケンスを含めることができます。 '<code>\a</code>' (ベル)、'<code>\b</code>' (バックスペース)、'<code>\f</code>' (改ページ)、'<code>\n</code>' (改行)、'<code>\r</code>' (復帰)、'<code>\t</code>' (水平タブ)、'<code>\v</code>' (垂直タブ)、'<code>\\</code>' (バックスラッシュ)、'<code>\"</code>' (引用符 [二重引用符])、および '<code>\'</code>' (アポストロフィ [単一引用符])。バックスラッシュの後に改行が続くと、文字列内の改行になります。エスケープシーケンス '<code>\z</code>' は、改行を含む後続の空白文字スパンをスキップします。これは、文字列の内容に改行やスペースを追加せずに、長いリテラル文字列を複数行に分割してインデントするのに特に役立ちます。短いリテラル文字列には、エスケープされていない改行や、有効なエスケープシーケンスを形成しないエスケープを含めることはできません。</p><p>埋め込まれたゼロを含む、短いリテラル文字列内の任意のバイトを、その数値で指定できます。これは、エスケープシーケンス <code>\x<em>XX</em></code>（<em>XX</em>は2つの16進数）またはエスケープシーケンス <code>\<em>ddd</em></code>（<em>ddd</em>は最大3つの10進数）を使用して行うことができます。（10進数のエスケープシーケンスの後に数字が続く場合は、正確に3桁で表現する必要があることに注意してください。）</p><p>Unicode文字のUTF-8エンコードは、エスケープシーケンス<code>\u{<em>XXX</em>}</code>（必須の括弧で囲む）を使用してリテラル文字列に挿入できます。ここで、<em>XXX</em>は文字コードポイントを表す1つ以上の16進数です。このコードポイントは、<em>2<sup>31</sup></em>未満の値にすることができます。（Luaはここで元のUTF-8仕様を使用しており、有効なUnicodeコードポイントに限定されません。）</p><p>リテラル文字列は、<em>長い括弧</em>で囲まれた長い形式を使用して定義することもできます。レベル<em>n</em>の<em>開始長い括弧</em>を、左角括弧の後に<em>n</em>個の等号が続き、その後に別の左角括弧が続くものとして定義します。したがって、レベル0の開始長い括弧は<code>[[</code>と記述され、レベル1の開始長い括弧は<code>[=[</code>と記述されます。<em>終了長い括弧</em>も同様に定義されます。たとえば、レベル4の終了長い括弧は<code>]====]</code>と記述されます。<em>長いリテラル</em>は、任意のレベルの開始長い括弧で始まり、同じレベルの最初の終了長い括弧で終わります。同じレベルの終了括弧を除く任意のテキストを含めることができます。この括弧形式のリテラルは、複数行にまたがることができ、エスケープシーケンスを解釈せず、他のレベルの長い括弧を無視します。あらゆる種類の行末シーケンス（復帰、改行、復帰に続く改行、または改行に続く復帰）は、単純な改行に変換されます。開始長い括弧の直後に改行が続く場合、その改行は文字列に含まれません。</p><p>例として、ASCIIを使用するシステム（ '<code>a</code>' が97、改行が10、 '<code>1</code>' が49としてコード化されている）では、以下の5つのリテラル文字列は同じ文字列を表します</p><pre>     a = 'alo\n123"'
     a = "alo\n123\""
     a = '\97lo\10\04923"'
     a = [[alo
     123"]]
     a = [==[
     alo
     123"]==]
</pre>

<p>前の規則によって明示的に影響を受けないリテラル文字列内の任意のバイトは、それ自身を表します。ただし、Luaは解析のためにテキストモードでファイルを開き、システムのファイル関数は一部の制御文字で問題が発生する可能性があります。したがって、バイナリデータは、テキスト以外の文字に対して明示的なエスケープシーケンスを使用する引用符付きリテラルとして表現する方が安全です。</p><p><em>数値定数</em>（または<em>数詞</em>）は、オプションの小数部と、文字 '<code>e</code>' または '<code>E</code>' でマークされたオプションの10進指数で記述できます。Luaは、<code>0x</code>または<code>0X</code>で始まる16進定数も受け入れます。16進定数は、オプションの小数部と、文字 '<code>p</code>' または '<code>P</code>' でマークされ、10進数で記述されたオプションのバイナリ指数も受け入れます。（たとえば、<code>0x1.fp10</code>は1984を示し、これは<em>0x1f / 16</em>に<em>2<sup>10</sup></em>を乗じたものです。）</p><p>基数点または指数を持つ数値定数は浮動小数点数を表します。それ以外の場合、その値が整数に適合するか、16進定数である場合は、整数を表します。それ以外の場合（つまり、オーバーフローする10進数の整数）、浮動小数点数を表します。基数点も指数もない16進数は常に整数値を表します。値がオーバーフローすると、有効な整数に収まるように<em>ラップアラウンド</em>します。</p><p>有効な整数定数の例を次に示します</p><pre>     3   345   0xff   0xBEBADA
</pre><p>有効な浮動小数点定数の例を次に示します</p><pre>     3.0     3.1416     314.16e-2     0.31416E1     34e1
     0x0.1E  0xA23p-4   0X1.921FB54442D18P+1
</pre>

<p><em>コメント</em>は、文字列の外側の任意の場所で二重ハイフン（<code>--</code>）で始まります。<code>--</code>の直後のテキストが開始長い括弧でない場合、コメントは<em>短いコメント</em>であり、行末まで実行されます。それ以外の場合、<em>長いコメント</em>であり、対応する終了長い括弧まで実行されます。</p>
</body>
</html>
