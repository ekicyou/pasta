## 6.3 – コルーチン操作

このライブラリはコルーチンを操作するための操作を構成し、テーブル `coroutine` の中にあります。コルーチンの一般的な説明については [§2.6](02-basic-concepts.md#26--コルーチン) を参照してください。

---

### coroutine.close ([co])

コルーチン `co` を閉じます。つまり、保留中のすべての to-be-closed 変数を閉じ、コルーチンを dead 状態にします。`co` のデフォルトは実行中のコルーチンです。

与えられたコルーチンは dead、suspended、または実行中のコルーチンでなければなりません。実行中のコルーチンの場合、この関数はリターンしません。代わりに、コルーチンを（再）開始した resume がリターンします。

他のコルーチンの場合、エラーが発生した場合（コルーチンを停止させた元のエラー、またはクローズメソッドでのエラー）、この関数は **false** とエラーオブジェクトを返します。そうでなければ **true** を返します。

---

### coroutine.create (f)

ボディ `f` を持つ新しいコルーチンを作成します。`f` は関数でなければなりません。この新しいコルーチン、型 `"thread"` を持つオブジェクトを返します。

---

### coroutine.isyieldable ([co])

コルーチン `co` が yield できる場合 **true** を返します。`co` のデフォルトは実行中のコルーチンです。

コルーチンは、メインスレッドではなく、yield 不可能な C 関数の中にない場合に yield 可能です。

---

### coroutine.resume (co [, val1, ···])

コルーチン `co` の実行を開始または継続します。コルーチンを最初に resume するとき、そのボディの実行を開始します。値 `val1`, ... はボディ関数への引数として渡されます。コルーチンが yield している場合、`resume` はそれを再開します。値 `val1`, ... は yield からの結果として渡されます。

コルーチンがエラーなく実行された場合、`resume` は **true** と、`yield` に渡された値（コルーチンが yield したとき）またはボディ関数によって返された値（コルーチンが終了したとき）を返します。エラーがある場合、`resume` は **false** とエラーメッセージを返します。

---

### coroutine.running ()

実行中のコルーチンとブール値を返します。実行中のコルーチンがメインの場合 **true** です。

---

### coroutine.status (co)

コルーチン `co` のステータスを文字列として返します：

| ステータス | 説明 |
|-----------|------|
| `"running"` | コルーチンが実行中（つまり、`status` を呼び出したもの） |
| `"suspended"` | コルーチンが `yield` の呼び出しで中断中、またはまだ実行を開始していない |
| `"normal"` | コルーチンはアクティブだが実行中ではない（つまり、別のコルーチンを resume した） |
| `"dead"` | コルーチンがボディ関数を終了した、またはエラーで停止した |

---

### coroutine.wrap (f)

ボディ `f` を持つ新しいコルーチンを作成します。`f` は関数でなければなりません。呼び出されるたびにコルーチンを resume する関数を返します。この関数に渡された引数は `resume` への追加引数として動作します。関数は `resume` によって返される値と同じ値を返しますが、最初のブール値は除きます。エラーの場合、関数はコルーチンを閉じてエラーを伝播します。

---

### coroutine.yield (···)

呼び出し側コルーチンの実行を中断します。`yield` への引数は `resume` への追加結果として渡されます。
