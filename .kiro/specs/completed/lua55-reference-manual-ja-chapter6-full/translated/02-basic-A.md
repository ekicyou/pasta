## 6.2 – 基本関数（パートA: assert-error）

基本ライブラリはLuaにコア関数を提供します。アプリケーションにこのライブラリを含めない場合は、その機能の一部について実装を提供する必要があるかどうかを慎重に確認してください。

---

### assert (v [, message])

引数 `v` の値が偽（すなわち **nil** または **false**）の場合、エラーを発生させます。そうでなければ、すべての引数を返します。エラーの場合、`message` がエラーオブジェクトになります。省略された場合、デフォルトは "`assertion failed!`" です。

---

### collectgarbage ([opt [, arg]])

この関数はガベージコレクタへの汎用インターフェースです。最初の引数 `opt` に応じて異なる機能を実行します：

- **`"collect"`**: 完全なガベージコレクションサイクルを実行します。これがデフォルトオプションです。

- **`"stop"`**: ガベージコレクタの自動実行を停止します。コレクタは再起動の呼び出しがあるまで、明示的に呼び出されたときのみ実行されます。

- **`"restart"`**: ガベージコレクタの自動実行を再開します。

- **`"count"`**: Luaが使用中の総メモリをキロバイト単位で返します。値には小数部があり、1024を掛けるとLuaが使用している正確なバイト数になります。

- **`"step"`**: ガベージコレクションのステップを実行します。このオプションには追加の引数として、ステップサイズを示す整数を続けることができます。

  サイズが正の `n` の場合、コレクタは `n` バイトの新規メモリが割り当てられたかのように動作します。サイズがゼロの場合、コレクタは基本ステップを実行します。インクリメンタルモードでは、基本ステップは現在のステップサイズに対応します。ジェネレーショナルモードでは、基本ステップは完全なマイナーコレクションを実行するか、コレクタがスケジュールしていればインクリメンタルステップを実行します。

  インクリメンタルモードでは、ステップがコレクションサイクルを終了した場合、関数は **true** を返します。ジェネレーショナルモードでは、ステップがメジャーコレクションを終了した場合、関数は **true** を返します。

- **`"isrunning"`**: コレクタが実行中（つまり停止していない）かどうかを示すブール値を返します。

- **`"incremental"`**: コレクタモードをインクリメンタルに変更し、以前のモードを返します。

- **`"generational"`**: コレクタモードをジェネレーショナルに変更し、以前のモードを返します。

- **`"param"`**: コレクタのパラメータの値を変更および/または取得します。このオプションには1つまたは2つの追加引数が必要です：変更または取得するパラメータの名前（文字列）と、そのパラメータのオプションの新しい値（範囲 *[0,100000]* の整数）。最初の引数は以下のいずれかの値でなければなりません：

  | パラメータ名 | 説明 |
  |-------------|------|
  | `"minormul"` | マイナー乗数 |
  | `"majorminor"` | メジャー-マイナー乗数 |
  | `"minormajor"` | マイナー-メジャー乗数 |
  | `"pause"` | ガベージコレクタの休止値 |
  | `"stepmul"` | ステップ乗数 |
  | `"stepsize"` | ステップサイズ |

  呼び出しは常にパラメータの以前の値を返します。呼び出しが新しい値を与えない場合、値は変更されません。

  Luaはこれらの値を圧縮形式で保存するため、以前の値として返される値は、最後に設定された値と正確に一致しない場合があります。

ガベージコレクションとこれらのオプションの一部についての詳細は、[§2.5](02-basic-concepts.md#25--ガベージコレクション) を参照してください。

この関数はファイナライザから呼び出すべきではありません。

---

### dofile ([filename])

指定されたファイルを開き、その内容をLuaチャンクとして実行し、チャンクが返すすべての値を返します。引数なしで呼び出された場合、`dofile` は標準入力（`stdin`）の内容を実行します。エラーの場合、`dofile` はエラーを呼び出し元に伝播します。（つまり、`dofile` は保護モードで実行されません。）

---

### error (message [, level])

`message` をエラーオブジェクトとしてエラーを発生させます（[§2.3](02-basic-concepts.md#23--エラー処理) 参照）。この関数は決してリターンしません。

通常、`error` はメッセージが文字列の場合、メッセージの先頭にエラー位置に関する情報を追加します。`level` 引数はエラー位置の取得方法を指定します。レベル1（デフォルト）では、エラー位置は `error` 関数が呼び出された場所です。レベル2では、`error` を呼び出した関数が呼び出された場所を指します。以下同様です。レベル0を渡すと、エラー位置情報のメッセージへの追加を回避します。
