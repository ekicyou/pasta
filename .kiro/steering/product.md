# Product Steering
Memories of pasta twine together—now and then a knot, yet always a delight.

## プロジェクト概要
**pasta**は、「伺か」のようなデスクトップマスコットなどを実現するためのスクリプトエンジンです。「パスタスクリプト」DSLを解釈し、runeスクリプト言語をバックエンドとした「ゴースト」基盤になるように設計されています。

## ビジョン
会話の記録というのは、長い長い一本の糸であり、パスタのように絡み合うことで意外性という面白さを提供できると考えます。

設計思想として前方一致によるランダムジャンプを主軸にすることで、ゴースト会話を記述可能なスクリプトエンジンを提供します。また、シナリオ型ゲームエンジンとしても流用可能なデータ構造を提供し、エンジンとして一定の地位を確立することを目指します。

## 目標
| 機能 | 説明 |
|------|------|
| 行指向文法 | 冒頭インデント＋キーワードで行属性決定 |
| ラベル前方一致 | ランダムJump/Call候補をシャッフル選択 |
| 単語前方一致 | 単語keyの前方一致でランダム選択 |
| SHIORI.DLL | 従来伺かユーザー向けインターフェース |
| areka統合 | 次世代デスクトップマスコット基盤 |

## コアバリュー
| 原則 | 内容 |
|------|------|
| 日本語フレンドリー | 全角キーワードでタイプ量削減 |
| UNICODE識別子 | 日本語ラベル名・変数名をサポート |
| yield型エンジン | 継続出力でチェイントーク対応 |
| runeトランスパイル | 2pass変換、複雑ロジックはrune側で実装 |

## ターゲットユーザー
- デスクトップマスコットの掛け合いを記述したいユーザー。
- シナリオ型ゲームなどのゲームエンジンが必要なユーザー。

## 機能の優先順位

### Phase 0: 一次設計の再構築（進行中）⚠️
**現状**: 過去11仕様は完了扱いだが、実装品質が要件定義意図を満たしておらず、**大規模な差し戻し・再設計中**

- [ ] 「パスタスクリプト」DSL設計の見直し
- [ ] ２パストランスパイル設計の再検討
- [ ] ラベルジャンプテーブル設計の修正
- [ ] 宣言的制御フロー（Call/Jump文）の再実装

**課題**:
- DSL文法の曖昧性・不完全性
- トランスパイル結果の品質問題
- ラベルテーブル設計の不備
- 要件と実装の乖離

**過去の「完了」仕様**: 12件（実装品質不十分、再評価必要）

### Phase 1: 基盤確立（未達）
Phase 0の再構築が完了するまで、基盤確立とは言えない状態。

### Phase 2: コア機能実装（保留）

**進行中仕様**: 8件（Phase 0完了後に着手）

### Phase 3: 高度機能（計画中）
- [ ] ラベル継続チェーン（`pasta-label-continuation`）
- [ ] インライン多段解決（`pasta-conversation-inline-multi-stage-resolution`）
- [ ] rune側ランタイムを拡充し、使い勝手を向上させる
- [ ] イベントハンドリングの拡充

### Phase 4: エコシステム統合（将来）
- [ ] SHIORI.DLLとしてのコンパイル
- [ ] arekaへの投入（`ukagaka-desktop-mascot`メタ仕様 - 32子仕様管理中）
- [ ] MCPまたはLLMとの連携（`areka-P0-mcp-server`）

**現在地**: Phase 0（一次設計再構築中）- **基盤未確立**
