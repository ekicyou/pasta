# 文法ステアリング

## ドキュメント体系

| ファイル | 対象 | 目的 |
|---------|------|------|
| `/SPECIFICATION.md` | 開発者 | **権威的仕様書** - 全11章、1,210行の完全な文法定義 |
| `/GRAMMAR.md` | 利用者 | **学習用ドキュメント** - クイックリファレンス、実用例 |

---

## 権威的仕様書

**開発時は必ず参照**: `/SPECIFICATION.md`

パーサー・トランスパイラー・ランタイムの実装判断はすべてこの仕様書に基づく。

---

## クイックリファレンス

### マーカー一覧（全角/半角両対応）

| マーカー | 全角 | 半角 | 用途 |
|---------|------|------|------|
| グローバルラベル | `＊` | `*` | ラベル定義 |
| ローカルラベル | `・` | `-` | サブラベル定義 |
| 属性 | `＆` | `&` | メタデータ |
| 単語/関数 | `＠` | `@` | 単語定義・参照・関数呼び出し |
| 変数 | `＄` | `$` | 変数宣言・参照 |
| Call | `＞` | `>` | ラベル呼び出し |
| コメント | `＃` | `#` | コメント行 |
| コロン | `：` | `:` | 区切り |

### 破壊的変更（2025-12 適用済み）

1. **Jump（？）廃止** → Call（＞）を使用
2. **Sakura エスケープ**: 半角 `\` のみ（全角 `＼` 不可）
3. **Sakura 括弧**: 半角 `[]` のみ（全角 `［］` 不可）
4. **text_part**: `$` を除外（インライン変数参照が正常動作）

---

## 主要パターン

### 基本構造
```pasta
＊会話                    # グローバルラベル
＆priority：10            # 属性
  ＠greeting：こんにちは おはよう  # ローカル単語定義
  Alice：＠greeting！\n    # アクション行（単語参照 + Sakura改行）
  ＄count：1              # 変数代入
  ＞次の会話              # Call（ローカルラベル）
  ・次の会話              # ローカルラベル
    Bob：続きです
```

### Rune ブロック
````pasta
＊計算
```rune
fn calculate(ctx) {
    let result = 10 + 20;
    result
}
```
  Alice：結果は ＠calculate() です
````

### 変数スコープ
```pasta
  ＄local_var：100        # ローカル変数（ラベル内）
  ＄＊global_var：200     # グローバル変数（ファイル全体）
```

---

## 関連ファイル

- [pest-grammar-alignment-analysis.md](./pest-grammar-alignment-analysis.md) - pest定義との整合性分析（参考）
- [domain.md](./domain.md) - ドメイン用語集

---

## 更新履歴

- 2025-12-19: 初版作成（pasta-grammar-specification 完了に伴い）
