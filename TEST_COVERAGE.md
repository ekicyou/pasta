# Test Coverage Map

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€[SOUL.md](SOUL.md) ã§å®šç¾©ã•ã‚ŒãŸã‚³ã‚¢æ©Ÿèƒ½ã¨ã€ãã‚Œã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆã®å¯¾å¿œé–¢ä¿‚ã‚’ç¤ºã—ã¾ã™ã€‚

**æœ€çµ‚æ›´æ–°**: 2026-01-25  
**ç·ãƒ†ã‚¹ãƒˆæ•°**: 483ãƒ†ã‚¹ãƒˆï¼ˆå…¨ãƒ‘ã‚¹ âœ…ï¼‰

---

## 1. ã‚³ã‚¢ãƒãƒªãƒ¥ãƒ¼ã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

| ã‚³ã‚¢ãƒãƒªãƒ¥ãƒ¼ | å¯¾å¿œãƒ†ã‚¹ãƒˆ | çŠ¶æ…‹ | ãƒ†ã‚¹ãƒˆæ•° |
|-------------|-----------|------|---------|
| æ—¥æœ¬èªãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ï¼ˆå…¨è§’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | 24 |
| UNICODEè­˜åˆ¥å­ï¼ˆæ—¥æœ¬èªã‚·ãƒ¼ãƒ³åãƒ»å¤‰æ•°åï¼‰ | `japanese_identifier_test.rs`<br>`ucid_test.rs` | âœ… å®Œäº† | 2<br>3 |
| yieldå‹ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆç¶™ç¶šå‡ºåŠ›ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | - |
| å®£è¨€çš„ãƒ•ãƒ­ãƒ¼ï¼ˆCallåˆ¶å¾¡ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | - |

---

## 2. DSLæ–‡æ³•æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

### 2.1 Parserå±¤ãƒ†ã‚¹ãƒˆï¼ˆæ–‡æ³•è§£æï¼‰

| æ©Ÿèƒ½ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ | èª¬æ˜ |
|------|---------------|------|------|
| ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚·ãƒ¼ãƒ³ï¼ˆï¼Šï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | ã‚·ãƒ¼ãƒ³å®šç¾©ãƒ‘ãƒ¼ã‚¹ |
| ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ãƒ¼ãƒ³ï¼ˆãƒ»ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | ã‚µãƒ–ã‚·ãƒ¼ãƒ³å®šç¾© |
| ã‚¢ã‚¯ã‚¿ãƒ¼å®šç¾©ï¼ˆï¼…ï¼‰ | `actor_code_block_test.rs` | âœ… å®Œäº† | ã‚¢ã‚¯ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ |
| å±æ€§å®šç¾©ï¼ˆï¼†ï¼‰ | ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚ã‚Š | ğŸ”¶ éƒ¨åˆ† | `transpiler2/attribute_inheritance.pasta` |
| å˜èªå®šç¾©ï¼ˆï¼ ï¼‰ | `actor_word_dictionary_test.rs` | âœ… å®Œäº† | å˜èªå®šç¾©ãƒ»å‚ç…§ |
| å¤‰æ•°å®šç¾©ï¼ˆï¼„ï¼‰ | ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚ã‚Š | ğŸ”¶ éƒ¨åˆ† | `transpiler2/variable_scope.pasta` |
| Callæ–‡ï¼ˆï¼ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ |
| ã‚³ãƒ¡ãƒ³ãƒˆè¡Œï¼ˆï¼ƒï¼‰ | æš—é»™çš„ãƒ†ã‚¹ãƒˆ | ğŸ”¶ éƒ¨åˆ† | æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆãªã— |
| ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¡Œï¼ˆç™ºè¨€ï¼‰ | `transpiler_integration_test.rs` | âœ… å®Œäº† | ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç™ºè¨€ |
| Luaã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ | `actor_code_block_test.rs` | âœ… å®Œäº† | é–¢æ•°å®šç¾© |
| ãƒã‚¤ãƒˆã‚ªãƒ•ã‚»ãƒƒãƒˆ | `span_byte_offset_test.rs` | âœ… å®Œäº† | ã‚¨ãƒ©ãƒ¼ä½ç½®ç‰¹å®š |

### 2.2 Registryå±¤ãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒ¼ãƒ³/å˜èªãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

| æ©Ÿèƒ½ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ | èª¬æ˜ |
|------|---------------|------|------|
| ã‚·ãƒ¼ãƒ³å‰æ–¹ä¸€è‡´æ¤œç´¢ | `search_module_test.rs`<br>`fallback_search_integration_test.rs` | âœ… å®Œäº† | å‰æ–¹ä¸€è‡´+ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ |
| å˜èªå‰æ–¹ä¸€è‡´æ¤œç´¢ | `search_module_test.rs` | âœ… å®Œäº† | å˜èªè¾æ›¸æ¤œç´¢ |
| å˜èªãƒ©ãƒ³ãƒ€ãƒ é¸æŠ | `search_module_test.rs` | ğŸ”¶ éƒ¨åˆ† | ãƒ©ãƒ³ãƒ€ãƒ æ€§æ¤œè¨¼ |
| ã‚¢ã‚¯ã‚¿ãƒ¼å˜èªè¾æ›¸ | `actor_word_dictionary_test.rs` | âœ… å®Œäº† | ã‚¢ã‚¯ã‚¿ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ—å˜èª |
| finalize_sceneå‡¦ç† | `finalize_scene_test.rs` | âœ… å®Œäº† | ã‚·ãƒ¼ãƒ³åˆæœŸåŒ– |

### 2.3 Transpilerå±¤ãƒ†ã‚¹ãƒˆï¼ˆLuaå¤‰æ›ï¼‰

| æ©Ÿèƒ½ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ | èª¬æ˜ |
|------|---------------|------|------|
| åŒ…æ‹¬çš„åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ | `transpiler_integration_test.rs` | âœ… å®Œäº† | 24ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ |
| å¤‰æ•°ã‚¹ã‚³ãƒ¼ãƒ— | ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚ã‚Š | ğŸ”¶ éƒ¨åˆ† | Local/Globalå¤‰æ•° |
| Call/æœ«å°¾Callæœ€é©åŒ– | `transpiler_integration_test.rs` | âœ… å®Œäº† | è‡ªå‹•åˆ¤å®š |
| ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° | `pasta_lua_encoding_test.rs` | âœ… å®Œäº† | æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ |

### 2.4 Runtimeå±¤ãƒ†ã‚¹ãƒˆï¼ˆå®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ï¼‰

| æ©Ÿèƒ½ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ | èª¬æ˜ |
|------|---------------|------|------|
| Luaã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ­ãƒ¼ãƒ€ãƒ¼ | `loader_integration_test.rs` | âœ… å®Œäº† | ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ |
| æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | `stdlib_modules_test.rs` | âœ… å®Œäº† | stdlibæ©Ÿèƒ½ |
| æ­£è¦è¡¨ç¾ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | `stdlib_regex_test.rs` | âœ… å®Œäº† | 14ãƒ†ã‚¹ãƒˆ |
| Luaå˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ | `lua_unittest_runner.rs` | âœ… å®Œäº† | Luaãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ |

### 2.5 çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆE2Eï¼‰

| æ©Ÿèƒ½ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | çŠ¶æ…‹ | èª¬æ˜ |
|------|---------------|------|------|
| SHIORI.DLL ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | `shiori_lifecycle_test.rs` | âœ… å®Œäº† | 5ãƒ†ã‚¹ãƒˆå…¨ãƒ‘ã‚¹ |
| SHIORI ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç† | `lua_request_test.rs` | âœ… å®Œäº† | 18+ãƒ†ã‚¹ãƒˆ |
| Runtime E2E | `runtime_e2e_test.rs` | âœ… å®Œäº† | 16ãƒ†ã‚¹ãƒˆï¼ˆæ–°è¦ï¼‰ |
| Finalize Scene | `finalize_scene_test.rs` | âœ… å®Œäº† | 14ãƒ†ã‚¹ãƒˆ |

---

## 3. Phase 0å®Œäº†åŸºæº–ã¨ã®å¯¾å¿œ

[SOUL.md Section 5.6](SOUL.md#56-phase-0å®Œäº†åŸºæº–definition-of-done) ã®DoDé …ç›®ã¨ãƒ†ã‚¹ãƒˆã®å¯¾å¿œï¼š

| DoDé …ç›® | å¯¾å¿œãƒ†ã‚¹ãƒˆ | çŠ¶æ…‹ |
|---------|-----------|------|
| SPECIFICATION.md å…¨ãƒãƒ¼ã‚«ãƒ¼å®šç¾©å®Œäº† | - | âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| å…¨è§’/åŠè§’å¯¾å¿œè¡¨ã®å®Œå…¨æ€§ | - | âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| cargo test pasta_core 100%ãƒ‘ã‚¹ | å…¨pasta_coreãƒ†ã‚¹ãƒˆ | âœ… 91ãƒ†ã‚¹ãƒˆ |
| cargo test pasta_lua 100%ãƒ‘ã‚¹ | å…¨pasta_luaãƒ†ã‚¹ãƒˆ | âœ… 249ãƒ†ã‚¹ãƒˆ |
| cargo test pasta_shiori 100%ãƒ‘ã‚¹ | `shiori_lifecycle_test.rs` | âœ… å…¨ãƒ‘ã‚¹ |
| comprehensive_control_flowæ¤œè¨¼ | `transpiler_integration_test.rs` | ğŸ”¶ Luaç‰ˆGolden Testæœªæ•´å‚™ |
| ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆæ•´å‚™ | - | âŒ æœªå®Ÿè£… |
| æœ€é©åŒ–ãƒ¬ãƒ™ãƒ«ã®æ–‡æ›¸åŒ– | - | âŒ æœªå®Ÿè£… |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§æ¤œè¨¼ | - | âœ… æœ¬ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§æ¤œè¨¼ |
| TEST_COVERAGE.mdä½œæˆ | - | âœ… æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| æœªãƒ†ã‚¹ãƒˆé ˜åŸŸã®ç‰¹å®š | - | âœ… æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Section 4å‚ç…§ |
| ã‚·ãƒ¼ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ | - | âŒ æœªå®Ÿæ–½ |
| Callæ–‡ã®å®Ÿè£… | `transpiler_integration_test.rs` | âœ… å®Œäº† |
| ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆæ•´å‚™ | å…¨483ãƒ†ã‚¹ãƒˆ | âœ… å®Œäº† |

---

## 4. æœªãƒ†ã‚¹ãƒˆé ˜åŸŸãƒ»æ”¹å–„ç‚¹

### 4.1 æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆãŒä¸è¶³ã—ã¦ã„ã‚‹é ˜åŸŸ

| æ©Ÿèƒ½ | ç¾çŠ¶ | æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|------|------|--------------|
| ã‚³ãƒ¡ãƒ³ãƒˆè¡Œï¼ˆï¼ƒï¼‰ãƒ‘ãƒ¼ã‚¹ | âœ… æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆè¿½åŠ æ¸ˆã¿ | `test_comment_line_explicit_parse()` |
| å±æ€§å®šç¾©ï¼ˆï¼†ï¼‰ã®ç¶™æ‰¿ | âœ… æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆè¿½åŠ æ¸ˆã¿ | `test_attribute_inheritance()` |
| å¤‰æ•°ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆLocal/Global/Systemï¼‰ | âœ… æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆè¿½åŠ æ¸ˆã¿ | `test_variable_scope_complete()` |
| å˜èªãƒ©ãƒ³ãƒ€ãƒ é¸æŠã®æ¤œè¨¼ | âœ… æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆè¿½åŠ æ¸ˆã¿ | `test_word_random_selection_and_replacement()` |
| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å…·ä½“æ€§ | âœ… æ˜ç¤ºçš„ãƒ†ã‚¹ãƒˆè¿½åŠ æ¸ˆã¿ | `test_error_message_specificity()` |

### 4.2 Golden Testï¼ˆã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼‰æœªæ•´å‚™

ç¾åœ¨ã€`comprehensive_control_flow.pasta` ã«å¯¾å¿œã™ã‚‹ `.rn` ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã™ãŒã€ã“ã‚Œã¯runeæ™‚ä»£ã®éºç‰©ã§ã™ã€‚Luaå‡ºåŠ›ã«å¯¾ã™ã‚‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒå¿…è¦ã§ã™ã€‚

**æ¨å¥¨**: `insta` crateã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆå°å…¥

### 4.3 pasta_shiori ãƒ†ã‚¹ãƒˆçŠ¶æ³ âœ… è§£æ±ºæ¸ˆã¿

ä»¥ä¸‹5ãƒ†ã‚¹ãƒˆãŒä¿®æ­£å®Œäº†ï¼š

- âœ… `test_shiori_load_sets_globals`
- âœ… `test_shiori_request_calls_pasta_scene`
- âœ… `test_shiori_request_increments_counter`
- âœ… `test_shiori_unload_creates_marker`
- âœ… `test_shiori_lifecycle_lua_execution_verified`

**ä¿®æ­£å†…å®¹**: 
- `pasta_lua/scripts/pasta/`ã‹ã‚‰å®Œå…¨ãªLuaãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã‚’`pasta_shiori/tests/support/scripts/pasta/`ã«ã‚³ãƒ”ãƒ¼
- `copy_fixture_to_temp()`ã®ã‚³ãƒ”ãƒ¼é †åºã‚’ä¿®æ­£ï¼ˆã‚µãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«â†’ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã®é †ï¼‰

---

## 5. ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚µãƒãƒªãƒ¼

| ã‚¯ãƒ¬ãƒ¼ãƒˆ | ãƒ†ã‚¹ãƒˆæ•° | ãƒ‘ã‚¹ | å¤±æ•— | ã‚«ãƒãƒ¬ãƒƒã‚¸è©•ä¾¡ |
|---------|---------|------|------|--------------|
| pasta_core | 94 | 94 | 0 | â­â­â­â­â­ å„ªç§€ |
| pasta_lua | 249 | 249 | 0 | â­â­â­â­â­ å„ªç§€ |
| pasta_shiori | 28 | 28 | 0 | â­â­â­â­â­ å„ªç§€ |
| **åˆè¨ˆ** | **483** | **483** | **0** | **100%ãƒ‘ã‚¹ç‡** |

---

## 6. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 0å®Œäº†ã«å‘ã‘ã¦

1. ~~**å„ªå…ˆåº¦ High**: pasta_shiori 5ãƒ†ã‚¹ãƒˆå¤±æ•—ã®ä¿®æ­£~~ âœ… å®Œäº†
2. **å„ªå…ˆåº¦ High**: Golden Testï¼ˆã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼‰æ•´å‚™
3. **å„ªå…ˆåº¦ Medium**: æœ€é©åŒ–ãƒ¬ãƒ™ãƒ«ã®æ–‡æ›¸åŒ–
4. **å„ªå…ˆåº¦ Medium**: ã‚·ãƒ¼ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼

### ä¿å®ˆãƒ»æ‹¡å¼µ

- æ–°è¦ãƒ†ã‚¹ãƒˆè¿½åŠ æ™‚ã¯æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°
- å››åŠæœŸã”ã¨ã«ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½
- Phase 1ä»¥é™ã®æ©Ÿèƒ½è¿½åŠ æ™‚ã¯å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’å…ˆã«ä½œæˆï¼ˆTest-Firstï¼‰

---

**å‚ç…§**:
- [SOUL.md](SOUL.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ†²æ³•
- [.kiro/specs/soul-document/gap-analysis.md](.kiro/specs/soul-document/gap-analysis.md) - ã‚®ãƒ£ãƒƒãƒ—åˆ†æãƒ¬ãƒãƒ¼ãƒˆ
